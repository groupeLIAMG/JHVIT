<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Module JHVIT &mdash; JHVIT 0.0.1 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="references.html" />
    <link rel="prev" title="Code documentation" href="code.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> JHVIT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="results.html">Results</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="code.html">Code documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Module JHVIT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">JHVIT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="code.html">Code documentation</a> &raquo;</li>
      <li>Module JHVIT</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/code_JHVIT.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-JHVI_Tetra">
<span id="module-jhvit"></span><h1>Module JHVIT<a class="headerlink" href="#module-JHVI_Tetra" title="Permalink to this headline"></a></h1>
<p>Join Hypocenter-Velocity Inversion on Tetrahedral meshes (JHVIT).</p>
<p>6 functions can be called and run in this package:</p>
<blockquote>
<div><dl class="simple">
<dt>1- jntHypoVel_T<span class="classifier">Joint hypocenter-velocity inversion of P wave data,</span></dt><dd><p>parametrized via the velocity model.</p>
</dd>
<dt>2- jntHyposlow_T<span class="classifier">Joint hypocenter-velocity inversion of P wave data,</span></dt><dd><p>parametrized via the slowness model.</p>
</dd>
<dt>3- jntHypoVelPS_T<span class="classifier">Joint hypocenter-velocity inversion of P- and S-wave data,</span></dt><dd><p>parametrized via the velocity models.</p>
</dd>
<dt>4- jntHyposlowPS_T<span class="classifier">Joint hypocenter-velocity inversion of P- and S-wave data,</span></dt><dd><p>parametrized via the slowness models.</p>
</dd>
<dt>5-jointHypoVel_T<span class="classifier">Joint hypocenter-velocity inversion of P wave data.</span></dt><dd><p>Input data and inversion parameters are downloaded automatically
from external text files.</p>
</dd>
<dt>6-jointHypoVelPS_T<span class="classifier">Joint hypocenter-velocity inversion of P- and S-wave data.</span></dt><dd><p>Input data and inversion parameters are downloaded automatically
from external text files.</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>Notes:</dt><dd><ul class="simple">
<li><p>The package ttcrpy must be installed in order to perform the raytracing step.
This package can be downloaded from: <a class="reference external" href="https://ttcrpy.readthedocs.io/en/latest/">https://ttcrpy.readthedocs.io/en/latest/</a></p></li>
<li><p>To prevent bugs, it would be better to use python 3.7</p></li>
</ul>
</dd>
</dl>
<p>Created on Sat Sep 14 2019
&#64;author: maher nasr</p>
<dl class="py function">
<dt id="JHVI_Tetra.check_hypo_indomain">
<code class="sig-prename descclassname">JHVI_Tetra.</code><code class="sig-name descname">check_hypo_indomain</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Hypo_new</span></em>, <em class="sig-param"><span class="n">P_Dimension</span></em>, <em class="sig-param"><span class="n">Mesh</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#JHVI_Tetra.check_hypo_indomain" title="Permalink to this definition"></a></dt>
<dd><p>Check if the new hypocenter is still inside the domain and
project it onto the domain surface otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Hypo_new</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>3</em><em>, </em><em>) or </em><em>(</em><em>3</em><em>,</em><em>1</em><em>)</em>) – The updated hypocenter coordinates.</p></li>
<li><p><strong>P_Dimension</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>6</em><em>, </em><em>)</em>) – Domain borders: the maximum and minimum of its 3 dimensions.</p></li>
<li><p><strong>Mesh</strong> (<em>instance of the class tmesh</em><em>, </em><em>optional</em>) – The domain discretization. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Hypo_new</strong> (<em>np.ndarray, shape (3, )</em>) – The input Hypo_new or its projections on the domain surface.</p></li>
<li><p><strong>outside</strong> (<em>boolean</em>) – True if Hypo_new was outside the domain.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="JHVI_Tetra.jntHypoVelPS_T">
<code class="sig-prename descclassname">JHVI_Tetra.</code><code class="sig-name descname">jntHypoVelPS_T</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obsData</span></em>, <em class="sig-param"><span class="n">calibdata</span></em>, <em class="sig-param"><span class="n">Vinit</span></em>, <em class="sig-param"><span class="n">cells</span></em>, <em class="sig-param"><span class="n">nodes</span></em>, <em class="sig-param"><span class="n">rcv</span></em>, <em class="sig-param"><span class="n">Hypo0</span></em>, <em class="sig-param"><span class="n">par</span></em>, <em class="sig-param"><span class="n">threads</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">vPnts</span><span class="o">=</span><span class="default_value">array([], dtype=float64), array([], dtype=float64)</span></em>, <em class="sig-param"><span class="n">basename</span><span class="o">=</span><span class="default_value">'Vel'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#JHVI_Tetra.jntHypoVelPS_T" title="Permalink to this definition"></a></dt>
<dd><p>Joint hypocenter-velocity inversion from P- and S-wave arrival time data
parametrized using the velocity models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obsData</strong> (<em>tuple of two np.ndarrays</em><em> (</em><em>shape</em><em>(</em><em>observed data number</em><em>, </em><em>3</em><em>)</em><em>)</em>) – Observed arrival time data of P- and S-waves.</p></li>
<li><p><strong>calibdata</strong> (<em>tuple of two np.ndarrays</em><em> (</em><em>shape</em><em> (</em><em>number of calibration shots</em><em>, </em><em>5</em><em>)</em><em>)</em>) – Calibration data of P- and S-waves.</p></li>
<li><p><strong>Vinit</strong> (<em>tuple of np.ndarrays</em><em> (</em><em>shape</em><em> (</em><em>nnodes</em><em>, </em><em>1</em><em>) or </em><em>(</em><em>1</em><em>,</em><em>1</em><em>)</em><em>)</em>) – Initial velocity models of P- and S-waves.</p></li>
<li><p><strong>cells</strong> (<em>np.ndarray of int</em><em>, </em><em>shape</em><em> (</em><em>cell number</em><em>, </em><em>4</em><em>)</em>) – Indices of nodes forming the cells.</p></li>
<li><p><strong>nodes</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>nnodes</em><em>, </em><em>3</em><em>)</em>) – Node coordinates.</p></li>
<li><p><strong>rcv</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>receiver number</em><em>,</em><em>3</em><em>)</em>) – Coordinates of receivers.</p></li>
<li><p><strong>Hypo0</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em>(</em><em>event number</em><em>, </em><em>5</em><em>)</em>) – First guesses of the hypocenter coordinates (must be all diffirent).</p></li>
<li><p><strong>par</strong> (<em>instance of the class Parameters</em>) – The inversion parameters.</p></li>
<li><p><strong>threads</strong> (<em>int</em><em>, </em><em>optional</em>) – Thread number. The default is 1.</p></li>
<li><p><strong>vPnts</strong> (<em>tuple of two np.ndarrays</em><em>, </em><em>optional</em>) – Known velocity points of P- and S-waves.
The default is (np.array([]), np.array([])).</p></li>
<li><p><strong>basename</strong> (<em>string</em><em>, </em><em>optional</em>) – The filename used to save the output files. The default is ‘Vel’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the Vs/Vp ratio is inverted instead of Vs model and some
    known velocity points are given for the S wave and not for the P wave.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>output</strong> – It contains the estimated hypocenter coordinates and their origin times,
static correction values, velocity models of P- and S-waves,
hypocenter convergence states, parameter uncertainty and
residual norm in each iteration.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>python dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="JHVI_Tetra.jntHypoVel_T">
<code class="sig-prename descclassname">JHVI_Tetra.</code><code class="sig-name descname">jntHypoVel_T</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">caldata</span></em>, <em class="sig-param"><span class="n">Vinit</span></em>, <em class="sig-param"><span class="n">cells</span></em>, <em class="sig-param"><span class="n">nodes</span></em>, <em class="sig-param"><span class="n">rcv</span></em>, <em class="sig-param"><span class="n">Hypo0</span></em>, <em class="sig-param"><span class="n">par</span></em>, <em class="sig-param"><span class="n">threads</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">vPoints</span><span class="o">=</span><span class="default_value">array([], dtype=float64)</span></em>, <em class="sig-param"><span class="n">basename</span><span class="o">=</span><span class="default_value">'Vel'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#JHVI_Tetra.jntHypoVel_T" title="Permalink to this definition"></a></dt>
<dd><p>Joint hypocenter-velicoty inversion from P wave arrival time data
parametrized using the velocity model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em>(</em><em>arrival time number</em><em>, </em><em>3</em><em>)</em>) – Arrival times and corresponding receivers for each event..</p></li>
<li><p><strong>caldata</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em>(</em><em>number of calibration shots</em><em>, </em><em>3</em><em>)</em>) – Calibration shot data.</p></li>
<li><p><strong>Vinit</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em>(</em><em>nnodes</em><em>,</em><em>1</em><em>) or </em><em>(</em><em>1</em><em>,</em><em>1</em><em>)</em>) – Initial velocity model.</p></li>
<li><p><strong>cells</strong> (<em>np.ndarray of int</em><em>, </em><em>shape</em><em> (</em><em>cell number</em><em>, </em><em>4</em><em>)</em>) – Indices of nodes forming the cells.</p></li>
<li><p><strong>nodes</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>nnodes</em><em>, </em><em>3</em><em>)</em>) – Node coordinates.</p></li>
<li><p><strong>rcv</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>receiver number</em><em>,</em><em>3</em><em>)</em>) – Coordinates of receivers.</p></li>
<li><p><strong>Hypo0</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em>(</em><em>event number</em><em>, </em><em>5</em><em>)</em>) – First guesses of the hypocenter coordinates (must be all diffirent).</p></li>
<li><p><strong>par</strong> (<em>instance of the class Parameters</em>) – The inversion parameters.</p></li>
<li><p><strong>threads</strong> (<em>int</em><em>, </em><em>optional</em>) – Thread number. The default is 1.</p></li>
<li><p><strong>vPoints</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em>(</em><em>point number</em><em>,</em><em>4</em><em>)</em><em>, </em><em>optional</em>) – Known velocity points. The default is np.array([]).</p></li>
<li><p><strong>basename</strong> (<em>string</em><em>, </em><em>optional</em>) – The filename used to save the output file. The default is ‘Vel’.</p></li>
<li><p><strong>Returns</strong> – </p></li>
<li><p><strong>-------</strong> – </p></li>
<li><p><strong>output</strong> (<em>python dictionary</em>) – It contains the estimated hypocenter coordinates and their origin times,
static correction values, velocity model, convergence states,
parameter uncertainty and residual norm in each iteration.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="JHVI_Tetra.jntHyposlowPS_T">
<code class="sig-prename descclassname">JHVI_Tetra.</code><code class="sig-name descname">jntHyposlowPS_T</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obsData</span></em>, <em class="sig-param"><span class="n">calibdata</span></em>, <em class="sig-param"><span class="n">Vinit</span></em>, <em class="sig-param"><span class="n">cells</span></em>, <em class="sig-param"><span class="n">nodes</span></em>, <em class="sig-param"><span class="n">rcv</span></em>, <em class="sig-param"><span class="n">Hypo0</span></em>, <em class="sig-param"><span class="n">par</span></em>, <em class="sig-param"><span class="n">threads</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">vPnts</span><span class="o">=</span><span class="default_value">array([], dtype=float64), array([], dtype=float64)</span></em>, <em class="sig-param"><span class="n">basename</span><span class="o">=</span><span class="default_value">'Slowness'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#JHVI_Tetra.jntHyposlowPS_T" title="Permalink to this definition"></a></dt>
<dd><p>Joint hypocenter-velocity inversion from P- and S-wave arrival time data
parametrized using the slowness models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obsData</strong> (<em>tuple of two np.ndarrays</em><em> (</em><em>shape</em><em>(</em><em>observed data number</em><em>, </em><em>3</em><em>)</em><em>)</em>) – Observed arrival time data of P- and S-waves.</p></li>
<li><p><strong>calibdata</strong> (<em>tuple of two np.ndarrays</em><em> (</em><em>shape</em><em> (</em><em>calibration shot number</em><em>, </em><em>6</em><em>)</em><em>)</em>) – Calibration data of P- and S-waves.</p></li>
<li><p><strong>Vinit</strong> (<em>tuple of np.ndarrays</em><em> (</em><em>shape</em><em> (</em><em>nnodes</em><em>, </em><em>1</em><em>) or </em><em>(</em><em>1</em><em>,</em><em>1</em><em>)</em><em>)</em>) – Initial velocity models of P- and S-waves.</p></li>
<li><p><strong>cells</strong> (<em>np.ndarray of int</em><em>, </em><em>shape</em><em> (</em><em>cell number</em><em>, </em><em>4</em><em>)</em>) – Indices of nodes forming the cells.</p></li>
<li><p><strong>nodes</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>nnodes</em><em>, </em><em>3</em><em>)</em>) – Node coordinates.</p></li>
<li><p><strong>rcv</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>receiver number</em><em>,</em><em>3</em><em>)</em>) – Coordinates of receivers.</p></li>
<li><p><strong>Hypo0</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em>(</em><em>event number</em><em>, </em><em>5</em><em>)</em>) – First guesses of the hypocenter coordinates (must be all diffirent).</p></li>
<li><p><strong>par</strong> (<em>instance of the class Parameters</em>) – The inversion parameters.</p></li>
<li><p><strong>threads</strong> (<em>int</em><em>, </em><em>optional</em>) – Thread number. The default is 1.</p></li>
<li><p><strong>vPnts</strong> (<em>tuple of two np.ndarrays</em><em>, </em><em>optional</em>) – Known velocity points of P- and S-waves.
The default is (np.array([]),np.array([])).</p></li>
<li><p><strong>basename</strong> (<em>string</em><em>, </em><em>optional</em>) – The filename used to save the output files. The default is ‘Slowness’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the Ss/Sp ratio is inverted instead of Vs model and some
    known velocity points are given for the S wave and not for the P wave.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>output</strong> – It contains the estimated hypocenter coordinates and their origin times,
static correction values, velocity models of P- and S-waves,
hypocenter convergence states, parameter uncertainty and
residual norm in each iteration.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>python dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="JHVI_Tetra.jntHyposlow_T">
<code class="sig-prename descclassname">JHVI_Tetra.</code><code class="sig-name descname">jntHyposlow_T</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">caldata</span></em>, <em class="sig-param"><span class="n">Vinit</span></em>, <em class="sig-param"><span class="n">cells</span></em>, <em class="sig-param"><span class="n">nodes</span></em>, <em class="sig-param"><span class="n">rcv</span></em>, <em class="sig-param"><span class="n">Hypo0</span></em>, <em class="sig-param"><span class="n">par</span></em>, <em class="sig-param"><span class="n">threads</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">vPoints</span><span class="o">=</span><span class="default_value">array([], dtype=float64)</span></em>, <em class="sig-param"><span class="n">basename</span><span class="o">=</span><span class="default_value">'Slowness'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#JHVI_Tetra.jntHyposlow_T" title="Permalink to this definition"></a></dt>
<dd><p>Joint hypocenter-velicoty inversion from P wave arrival time data
parametrized using the slowness model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em>(</em><em>arrival time number</em><em>, </em><em>3</em><em>)</em>) – Arrival times and corresponding receivers for each event.</p></li>
<li><p><strong>caldata</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em>(</em><em>number of calibration shots</em><em>, </em><em>6</em><em>)</em>) – Calibration shot data.</p></li>
<li><p><strong>Vinit</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em>(</em><em>nnodes</em><em>,</em><em>1</em><em>) or </em><em>(</em><em>1</em><em>,</em><em>1</em><em>)</em>) – Initial velocity model.</p></li>
<li><p><strong>Cells</strong> (<em>np.ndarray of int</em><em>, </em><em>shape</em><em> (</em><em>cell number</em><em>, </em><em>4</em><em>)</em>) – Indices of nodes forming the cells.</p></li>
<li><p><strong>nodes</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>nnodes</em><em>, </em><em>3</em><em>)</em>) – Node coordinates.</p></li>
<li><p><strong>rcv</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>receiver number</em><em>,</em><em>3</em><em>)</em>) – Coordinates of receivers.</p></li>
<li><p><strong>Hypo0</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em>(</em><em>event number</em><em>, </em><em>5</em><em>)</em>) – First guesses of the hypocenter coordinates (must be all diffirent).</p></li>
<li><p><strong>par</strong> (<em>instance of the class Parameters</em>) – The inversion parameters.</p></li>
<li><p><strong>threads</strong> (<em>int</em><em>, </em><em>optional</em>) – Thread number. The default is 1.</p></li>
<li><p><strong>vPoints</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em>(</em><em>point number</em><em>,</em><em>4</em><em>)</em><em>, </em><em>optional</em>) – Known velocity points. The default is np.array([]).</p></li>
<li><p><strong>basename</strong> (<em>string</em><em>, </em><em>optional</em>) – The filename used to save the output files. The default is ‘Slowness’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – It contains the estimated hypocenter coordinates and their origin times,
static correction values, velocity model, convergence states,
parameter uncertainty and residual norm in each iteration.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>python dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="JHVI_Tetra.jointHypoVelPS_T">
<code class="sig-prename descclassname">JHVI_Tetra.</code><code class="sig-name descname">jointHypoVelPS_T</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inputFileParam</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">'slow'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#JHVI_Tetra.jointHypoVelPS_T" title="Permalink to this definition"></a></dt>
<dd><p>Joint hypocenter-velocity inversion using P- and S-wave arrival time data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputFileParam</strong> (<em>string</em>) – Text file containing inversion parameters and data filenames.</p></li>
<li><p><strong>model</strong> (<em>string</em>) – Sought models: ‘vel’ for an inversion problem parametrized using
the velocity model, ‘slow’ for an inversion problem parametrized
using the slowness model. The default is ‘slow’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>It contains the estimated hypocenter coordinates and their origin times,
static correction values, velocity models of P and S waves, hypocenter
convergence states, parameter uncertainty and residual norm in each
iteration.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>python dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="JHVI_Tetra.jointHypoVel_T">
<code class="sig-prename descclassname">JHVI_Tetra.</code><code class="sig-name descname">jointHypoVel_T</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inputFileParam</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">'slow'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#JHVI_Tetra.jointHypoVel_T" title="Permalink to this definition"></a></dt>
<dd><p>Joint hypocenter-velocity inversion using P wave data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputFileParam</strong> (<em>string</em>) – Text file containing inversion parameters and data filenames.</p></li>
<li><p><strong>model</strong> (<em>string</em>) – Sought model : ‘vel’ for an inversion problem parametrized using
the velocity model,’slow’ for an inversion problem parametrized using
the slowness model. The default is ‘slow’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>It contains the estimated hypocenter coordinates and their origin times,
static correction values, velocity model, convergence states,
parameter uncertainty and residual norm in each iteration.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>python dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="JHVI_Tetra.msh2vtk">
<code class="sig-prename descclassname">JHVI_Tetra.</code><code class="sig-name descname">msh2vtk</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nodes</span></em>, <em class="sig-param"><span class="n">cells</span></em>, <em class="sig-param"><span class="n">velocity</span></em>, <em class="sig-param"><span class="n">outputFilename</span></em>, <em class="sig-param"><span class="n">fieldname</span><span class="o">=</span><span class="default_value">'Velocity'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#JHVI_Tetra.msh2vtk" title="Permalink to this definition"></a></dt>
<dd><p>Generate a vtk file to store the velocity model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>nnodes</em><em>, </em><em>3</em><em>)</em>) – Node coordinates.</p></li>
<li><p><strong>cells</strong> (<em>np.ndarray of int</em><em>, </em><em>shape</em><em> (</em><em>number of cells</em><em>, </em><em>4</em><em>)</em>) – Indices of nodes forming each cell.</p></li>
<li><p><strong>velocity</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>nnodes</em><em>, </em><em>1</em><em>)</em>) – Velocity model.</p></li>
<li><p><strong>outputFilename</strong> (<em>string</em>) – The output vtk filename.</p></li>
<li><p><strong>fieldname</strong> (<em>string</em><em>, </em><em>optional</em>) – The saved field title. The default is “Velocity”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>return 0.0 if no bugs occur.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="JHVI_Tetra.readEventsFiles">
<code class="sig-prename descclassname">JHVI_Tetra.</code><code class="sig-name descname">readEventsFiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_file</span></em>, <em class="sig-param"><span class="n">waveType</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#JHVI_Tetra.readEventsFiles" title="Permalink to this definition"></a></dt>
<dd><p>Read a list of seismic events and corresponding data from a text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_file</strong> (<em>string</em>) – Event data filename.</p></li>
<li><p><strong>waveType</strong> (<em>bool</em>) – True if the seismic phase of each event is identified.
The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong> – Event arrival time data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray or a list of two np.ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="JHVI_Tetra.readVelpoints">
<code class="sig-prename descclassname">JHVI_Tetra.</code><code class="sig-name descname">readVelpoints</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vlpfile</span></em><span class="sig-paren">)</span><a class="headerlink" href="#JHVI_Tetra.readVelpoints" title="Permalink to this definition"></a></dt>
<dd><p>Read known velocity points from a text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vlpfile</strong> (<em>string</em>) – Name of the file containing the known velocity points.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong> – Data corresponding to the known velocity points.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray, shape (number of points , 3)</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="code.html" class="btn btn-neutral float-left" title="Code documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="references.html" class="btn btn-neutral float-right" title="References" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Maher Nasr.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>